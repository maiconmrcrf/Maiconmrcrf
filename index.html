<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üì∫ Marcos IPTV</title>
  <style>
    body { font-family: Arial, sans-serif; background: #0a0a1a; color: #fff; margin:0; padding:0; }
    header { text-align:center; padding:20px; background:#111; border-bottom:2px solid #00f3ff; }
    h1 { color:#00f3ff; margin:0; }
    .container { padding:20px; }
    .categoria { font-size:1.3rem; margin:20px 0 10px; padding:8px 10px; background:rgba(0,243,255,0.1); border-left:5px solid #ff00ff; color:#ff00ff; font-weight:bold; }
    .canal { padding:10px; margin:5px 0; background:rgba(255,255,255,0.05); border:1px solid rgba(0,243,255,0.2); border-radius:6px; transition: all 0.3s; }
    .canal a { color:#fff; text-decoration:none; display:block; }
    .canal:hover { background:rgba(0,243,255,0.2); transform:translateX(5px); }
    .download { display:inline-block; margin-top:15px; padding:10px 20px; background:#00f3ff; color:#000; font-weight:bold; text-decoration:none; border-radius:6px; }
  </style>
</head>
<body>
  <header>
    <h1>üì∫ Marcos IPTV Online</h1>
    <p>Escolha o canal e baixe sua lista</p>
    <a id="downloadLink" class="download" download="lista.m3u">‚¨áÔ∏è Baixar lista completa</a>
  </header>

  <div id="listaCanais" class="container">‚è≥ Carregando canais...</div>

  <script>
    // Host, usu√°rio e senha
    const host = "http://bmudnfh.megahdtv.xyz:900";
    const username = "0032829421";
    const password = "5272592091";

    // Link M3U gerado
    const m3uURL = `${host}/get.php?username=${username}&password=${password}&type=m3u&output=mpegts`;

    // Configura bot√£o de download para qualquer usu√°rio
    const downloadLink = document.getElementById("downloadLink");
    downloadLink.href = m3uURL;

    async function carregarM3U() {
      try {
        const resp = await fetch(m3uURL);
        const texto = await resp.text();
        parseM3U(texto);
      } catch (e) {
        document.getElementById("listaCanais").innerHTML = "<p>‚ùå N√£o foi poss√≠vel carregar a lista. Clique em 'Baixar lista completa' para acessar os canais.</p>";
      }
    }

    function parseM3U(texto) {
      const linhas = texto.split("\n");
      let canais = [];
      let categoria = "Outros";

      for (let i=0; i<linhas.length; i++) {
        if(linhas[i].startsWith("#EXTINF:")) {
          const info = linhas[i];
          const nome = info.split(",")[1] || "Sem Nome";
          const grupoMatch = info.match(/group-title="([^"]+)"/);
          if(grupoMatch) categoria = grupoMatch[1];
          const url = linhas[i+1];
          canais.push({nome, url, categoria});
        }
      }
      renderizarCanais(canais);
    }

    function renderizarCanais(canais) {
      const container = document.getElementById("listaCanais");
      container.innerHTML = "";
      let categoriaAtual = "";

      canais.forEach(canal => {
        if(canal.categoria !== categoriaAtual) {
          categoriaAtual = canal.categoria;
          const titulo = document.createElement("div");
          titulo.className = "categoria";
          titulo.textContent = categoriaAtual;
          container.appendChild(titulo);
        }

        const div = document.createElement("div");
        div.className = "canal";
        div.innerHTML = `<a href="${canal.url}" target="_blank">${canal.nome}</a>`;
        container.appendChild(div);
      });
    }

    carregarM3U();
  </script>
</body>
</html>
